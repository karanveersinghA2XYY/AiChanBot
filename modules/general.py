#genral handlers
from pyrogram import filters 
from pyrogram.types import InlineKeyboardMarkup, InlineKeyboardButton, Message, CallbackQuery
from config import neko
from .broadcast import addusertoDb

    
    
@neko.on_message(filters.command(["start"] ))
async def start(_, message: Message):
    await message.reply_text(
        text=f"**Hello {message.from_user.first_name} üëã !"
             "\n\nFeeling Tired of Useless Ai Bots? , Apple is here to rescue powered by ùêäùêï -ùê±ùêÉ ¬∞| . "
             "\n\nCheck About to know the use of me**",
        disable_web_page_preview=True,
        reply_markup=InlineKeyboardMarkup(
            [
                [
                    InlineKeyboardButton("‚ö°About", callback_data="‚ö°About"),
                    InlineKeyboardButton("üììHelp" , callback_data="üììHelp")
                ]
            ]
        ),
        reply_to_message_id=message.id
    )
    addusertoDb(message)

        
@neko.on_message(filters.command("about"))
async def about(_, message: Message):
    keyboard = [
        [
            InlineKeyboardButton("üì£Updates",
                                          url="https://t.me/AppleXEmpire"),
            InlineKeyboardButton("üöëSupport",
                                          url="https://t.me/ENGLISH_SPEAKERSSS"),
            InlineKeyboardButton("SHARE",url="https://t.me/share/url?url=https://t.me/Apple_Aibot")
        ],
    ]
    await message.reply_text(text =
                              "<b>Hey! Im AI-CHAN.</b>"
                              "\nI can help you explore many stuffs ,ask me anything."
                              "\n\n<b>About Me :</b>"
                              "\n\n  - <b>Name</b>        : <a href=\"https://t.me/Apple_Aibot/\">Apple </a>"
                              "\n\n  - <b>Creator</b>      : <a href=\"https://t.me/its_raveen/\">Raveen</a>"
                              "\n\n  - <b>Language</b>  : <a href=\"https://www.python.org/\">Python 3</a>"
                              "\n\n  - <b>Library</b>       : <a href=\"https://docs.pyrogram.org/\">PYROGRAM</a>"
                              "\n\n  - <b>Source Code</b>  : <a href=\"https://github.com/raveen2k3/AiChanBot\">Source Code</a>",    
        disable_web_page_preview = True ,
        reply_markup = InlineKeyboardMarkup(keyboard)
     )
    
donate_sus = "https://graph.org/file/1d609c5089ef2c1a7e6be.mp4"
@neko.on_message(filters.command(["donate"]))
async def donate(_, message: Message):
    chat_id =message.chat.id
    sponsor_msg = """First of All Im Thanking you for using \n\n/donate option
    \n\n Due To The Poor Server We Have In Our Hand We cant Provide You Better Service
    \n\n It would be be a great help if You Can Help Us To Improve Our Server
    \n\n you can use sponsor button by clicking below
    \n\n feel free to msg in group for alternative Payment Method :-)
    \n\n Anyways this Service will always be free And we Wont force You to pay us"""
    
    await neko.send_animation(chat_id, animation=donate_sus ,caption=sponsor_msg , reply_markup=InlineKeyboardMarkup(
            [
                [
                    InlineKeyboardButton(text="Support", url="https://telegram.me/BakaForum"),
                    InlineKeyboardButton(text="Donate" , url="https://github.com/sponsors/raveen2k3") ,
                    
                    


                ]
            ]
        )
    )  
    
    

    
@neko.on_message(filters.command("guidelines"))
async def guidelines(_, message: Message):
    text = """There are some general guidelines that everyone should follow when chatting with AiChan!.
    \n\nit is important to be respectful and courteous. 
    \n\nDo not use profanity or obscene language,
    \n\ndo not spam the chatbot with multiple messages, do not send duplicate messages.
    \n\nAdditionally, it is important to remember that even though AiChan is advanced, 
    \n\nit is not perfect and may not always understand what you are saying. 
    \n\nIf you are having difficulty communicating with it,
    \n\nit is best to try rephrasing your questions or statements."""
    await neko.send_message(message.chat.id , text ,reply_to_message_id=message.id)
    
    
@neko.on_callback_query()
async def cb_handler(_, query: CallbackQuery):
    if query.data == "About":
        
        await query.answer()
        
        keyboard = [
            [
                InlineKeyboardButton("Updates",
                                            url="https://t.me/BakaForum"),
                InlineKeyboardButton("Support",
                                            url="https://t.me/BakaForum"),
                InlineKeyboardButton("Share",url="https://t.me/share/url?url=https://t.me/AiChan69Bot")
            ],
                    ]
        await query.message.edit_text(text =
                                "<b>Hey! Im AI-CHAN.</b>"
                                "\nI can help you explore many stuffs ,ask me anything."
                                "\n\n<b>About Me :</b>"
                                "\n\n  - <b>Name</b>         : <a href=\"https://t.me/its_raveen/\">Ai Chan</a>"
                                "\n\n  - <b>Creator</b>      : <a href=\"https://t.me/BakaForum/\">Raveen</a>"
                                "\n\n  - <b>Language</b>     : <a href=\"https://www.python.org/\">Python 3</a>"
                                "\n\n  - <b>Library</b>      : <a href=\"https://docs.pyrogram.org/\">PYROGRAM</a>"
                                "\n\n  - <b>Source Code</b>  : <a href=\"https://github.com/raveen2k3/AiChanBot\">Source Code</a>",    
            disable_web_page_preview = True ,
            reply_markup = InlineKeyboardMarkup(keyboard)
            
        )
        
    elif query.data == "Help":
        await query.answer()
        keyboard = [
            [
                InlineKeyboardButton("Announcements",
                                            url="https://t.me/BakaForum"),
                InlineKeyboardButton("Support",
                                            url="https://t.me/BakaForum"),
                InlineKeyboardButton("Share",url="https://t.me/share/url?url=https://t.me/AiChan69Bot")
            ],
                    ]
        help_text ="""Hey Mate first checkout my /guidelines
        \n\n just send me your query i may able to answer it!
        \n\n Join Our Support group, for feature request or bug fixes
        """
        await query.message.edit_text(text=help_text, reply_markup = InlineKeyboardMarkup(keyboard))
